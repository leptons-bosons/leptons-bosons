<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Leptions, Bosons, Quarks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="virtualization, cloud">
<meta property="og:type" content="website">
<meta property="og:title" content="Leptions, Bosons, Quarks">
<meta property="og:url" content="https://username.github.io/leptons-bosons/page/2/index.html">
<meta property="og:site_name" content="Leptions, Bosons, Quarks">
<meta property="og:description" content="virtualization, cloud">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Henry">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/leptons-bosons/atom.xml" title="Leptions, Bosons, Quarks" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/leptons-bosons/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/leptons-bosons/css/style.css">

  
    
<link rel="stylesheet" href="/leptons-bosons/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/leptons-bosons/" id="logo">Leptions, Bosons, Quarks</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/leptons-bosons/" id="subtitle">light virt</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/leptons-bosons/">Home</a>
        
          <a class="main-nav-link" href="/leptons-bosons/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/leptons-bosons/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://username.github.io/leptons-bosons"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-design-patterns" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2019/10/02/design-patterns/" class="article-date">
  <time class="dt-published" datetime="2019-10-02T06:43:13.000Z" itemprop="datePublished">2019-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2019/10/02/design-patterns/">Design Patterns and UML</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Princinples"><a href="#Princinples" class="headerlink" title="Princinples"></a>Princinples</h1><ul>
<li><p>The Open Closed Princinple(OCP)<br>A module should be open for extension but closed for modification. In other words, modules can be extened, without requiring them to be modified in existing source codes. This means that, with a llitle forethought, wd can add new features to existing code, without changing the existing code and by only adding new code. Symptoms of Rotting Design, rigidity, fragility, immobility, vicosity.</p>
</li>
<li><p>The Liskov Substitution Princile(LSP)<br>Subclasses should be substitutable for their base classes. It alse derives freom the concept of Design by Contract(DBC), e.g. circle/ellipse dilemma.</p>
</li>
<li><p>The Dependency Inversion Principle(DIP)<br>Denpand upon abstractions, do not depend upon concretions.</p>
</li>
<li><p>The Interface Segregation Principle(ISP)<br>Many client specific interfaces are better than on general purpose interface.</p>
</li>
<li><p>Principles of Package architecture</p>
</li>
</ul>
<p>– The release reuse equivalency principle(REP), the granule of reuse is the granule of release.<br>– The common closure principle(CCP), classes that change together, belong together.<br>– The common reuse principle(CRP), classed that are not reused together should not be grouped together.<br>– The acyclic dependencies principle(ADP), the dependencies between packages must not form cycles.<br>– The stable dependencies principle(SDP), depend in the direction of stability.</p>
<h1 id="Patterns-of-Object-Oriented-Architecture"><a href="#Patterns-of-Object-Oriented-Architecture" class="headerlink" title="Patterns of Object Oriented Architecture"></a>Patterns of Object Oriented Architecture</h1><ul>
<li><p>Creational Patterns</p>
<ul>
<li>Abstract Factory, Factory Method<br>The DIP strongly recommends that modules not depend upon concrete classed. However, in order to create an instane fo a class, you must depend upon the concrete class. Abstract factory is a pattern that allows that dependency upon the concreate class to exist in on, and only one, place.</li>
<li>Template(extend), Builder(implement)</li>
<li>Singleton<br>Avoid creating an object everytime.</li>
<li>Decorator, Prototype</li>
</ul>
</li>
<li><p>Structural Patterns</p>
<ul>
<li>Adapter, Facade<br>When inserting an abstract interface is infeasible because the server is third party software, or is so heavily depended upon that it can not easily be changed, and ADAPTER can be used to bind the abstract interface to the server.<br>The adapter is an object that implements the abstract interface to delegate to the server. Every methon of the adpater simply translates and then delegates.</li>
<li>Bridge<br>One of the problems with implementing an abstract class with inheritance is that the derived class is so tightly coupled to the base classes. This can lead to problems when other clients want to use the derived class functions without draging along the bagae of the base hiearchy, decouple an abstraction from its implementation.<br>Adapter makes things work after they’re designed, bridge makes them work before they are.</li>
<li>Proxy, Abstract Server<br>When a client depends directly on a server, the DIP is violated. Changes to the server will propogate to the client, and the client will be unable to easily use similar servers. This can be recified by inserting an interface between the client and the server, to produce a unified interface for a number of underlying and unrelated objects.</li>
<li>Flyweight, Composite, Decorator</li>
</ul>
</li>
<li><p>Behavioral Patterns</p>
<ul>
<li>Observer<br>It often occurs that one element of a design needs to take some form of action when another element in the design dicovers that an event has occurred. However, we frequently donot want the detector to know about the actor.</li>
<li>Chain of Responsibility, Command, Interpreter, Iterator, Mediator, Mememnto</li>
<li>State, Strategy, Visitor</li>
<li>Template Method</li>
</ul>
</li>
</ul>
<h1 id="UML-Unified-Modeling-Language"><a href="#UML-Unified-Modeling-Language" class="headerlink" title="UML(Unified Modeling Language)"></a>UML(Unified Modeling Language)</h1><ul>
<li>UML Diagrams</li>
</ul>
<p>– Behavioral UML Diagram: Sequence Diagram: Activity diagram, Use Case diagram, Interaction Overview Diagram, Timing Diagram, State Machine Diagram, Communication Diagram, Sequence Diagram<br>– Structural UML Diagram: Class Diagram, Object Diagram, Component Diagram, Composite Structure Diagram, Deployment Diagram, Deployment Diagram, Profile Diagram</p>
<ul>
<li>UML Notations</li>
</ul>
<p>– Relationships: Dependency Notation, Association Notation, Generalization Notation, Extensibility Notation<br>– Relationships between classes<br><img src="07-relationships-between-classes.png" alt="Relationships between classes"><br>– Class Diagram Example: Order System<br><img src="17-class-diagram-example-order-system.png" alt="Class Diagram Example: Order System"><br>– Class Diagram Example: GUI<br><img src="18-uml-class-diagram-example-gui.png" alt="Class Diagram Example: GUI"></p>
<h1 id="Referencs"><a href="#Referencs" class="headerlink" title="Referencs"></a>Referencs</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.visual-paradigm.com/guide/uml-unified-modeling-language/uml-class-diagram-tutorial/">UML Class Diagram Tutorial</a></li>
<li><a target="_blank" rel="noopener" href="https://tallyfy.com/uml-diagram/#composite-structure-diagram">All You Need to Know About UML Diagrams: Types and 5+ Examples</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2019/10/02/design-patterns/" data-id="ckrqkh471000e2ovl14uc1xk1" data-title="Design Patterns and UML" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/design-patterns/" rel="tag">design patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/uml/" rel="tag">uml</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-function-calling-conventions" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/12/26/function-calling-conventions/" class="article-date">
  <time class="dt-published" datetime="2018-12-26T12:56:13.000Z" itemprop="datePublished">2018-12-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/12/26/function-calling-conventions/">Function Calling Conventions</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h3><ul>
<li>Passing arguments: “passing arguments” is a way of saying that the calling function is writing data in the place where the called function will look for them. Arguments are passed before the call instruction is executed.</li>
<li>Right-to-Left and Left-to-Right: describe the manner that arguments are passed to the subroutine, in terms of the High-level code. For instance, the following C function call:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MyFunction1(a, b);</span><br><span class="line">//will generate the following code if passed Left-to-Right:</span><br><span class="line">push a</span><br><span class="line">push b</span><br><span class="line">call _MyFunction</span><br><span class="line">//and will generate the following code if passed Right-to-Left:</span><br><span class="line">push b</span><br><span class="line">push a</span><br><span class="line">call _MyFunction</span><br></pre></td></tr></table></figure></li>
<li>Return value: Some functions return a value, and that value must be received reliably by the function’s caller. The called function places its return value in a place where the calling function can get it when execution returns. The called function stores the return value before executing the ret instruction.</li>
<li>Cleaning the stack: when arguments are pushed onto the stack, eventually they must be popped back off again. Whichever function, the caller or the callee, is responsible for cleaning the stack must reset the stack pointer to eliminate the passed arguments.</li>
<li>Calling function (the caller): The “parent” function that calls the subroutine. Execution resumes in the calling function directly after the subroutine call, unless the program terminates inside the subroutine.</li>
<li>Called function (the callee): The “child” function that gets called by the “parent”.</li>
<li>Name Decoration: When C code is translated to assembly code, the compiler will often “decorate” the function name by adding extra information that the linker will use to find and link to the correct functions. For most calling conventions, the decoration is very simple (often only an extra symbol or two to denote the calling convention), but in some extreme cases (notably C++ “thiscall” convention), the names are “mangled” severely.</li>
<li>Entry sequence (the function prologue): a few instructions at the beginning of a function, which prepare the stack and registers for use within the function.</li>
<li>Exit sequence (the function epilogue): a few instructions at the end of a function, which restore the stack and registers to the state expected by the caller, and return to the caller. Some calling conventions clean the stack in the exit sequence.</li>
<li>Call sequence: a few instructions in the middle of a function (the caller) which pass the arguments and call the called function. After the called function has returned, some calling conventions have one more instruction in the call sequence to clean the stack.</li>
</ul>
<h3 id="Stack-Frame"><a href="#Stack-Frame" class="headerlink" title="Stack Frame"></a>Stack Frame</h3><ul>
<li><p>Example Code, sum_till_max.c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">#define MAX (1UL &lt;&lt; 20)</span><br><span class="line"></span><br><span class="line">typedef unsigned long long u64;</span><br><span class="line">typedef unsigned int u32;</span><br><span class="line"></span><br><span class="line">u32 max_add_end = MAX;</span><br><span class="line"></span><br><span class="line">u64 sum_till_max(u32 n)</span><br><span class="line">&#123;</span><br><span class="line">  u64 sum;</span><br><span class="line">  n++;</span><br><span class="line">  sum = n;</span><br><span class="line"></span><br><span class="line">  if (n &lt; max_add_end)</span><br><span class="line">    sum += sum_till_max(n);</span><br><span class="line"></span><br><span class="line">  return sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">  u64 sum = 0;</span><br><span class="line"></span><br><span class="line">  if ((argc == 2) &amp;&amp; isdigit(*argv[1]))</span><br><span class="line">    max_add_end = strtoul(argv[1], NULL, 0);</span><br><span class="line"></span><br><span class="line">  if (max_add_end &gt; MAX || max_add_end == 0) &#123;</span><br><span class="line">    fprintf(stderr, &quot;Invalid number is specified\n&quot;);</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sum = sum_till_max(0);</span><br><span class="line">  printf(&quot;sum(0...%u) = %llu\n&quot;, max_add_end, sum);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Content Assemble Code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble main </span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x000000000040069b &lt;+0&gt;:	push   %rbp</span><br><span class="line">   0x000000000040069c &lt;+1&gt;:	mov    %rsp,%rbp</span><br><span class="line">   0x000000000040069f &lt;+4&gt;:	sub    $0x20,%rsp</span><br><span class="line">...</span><br><span class="line">   0x0000000000400744 &lt;+169&gt;:	jmp    0x400774 &lt;main+217&gt;</span><br><span class="line">   0x0000000000400746 &lt;+171&gt;:	mov    $0x0,%edi ----------------------------------------------------#1</span><br><span class="line">   0x000000000040074b &lt;+176&gt;:	callq  0x400666 &lt;sum_till_max&gt; --------------------------------------#2</span><br><span class="line">   0x0000000000400750 &lt;+181&gt;:	mov    %rax,-0x8(%rbp)</span><br><span class="line">   0x0000000000400754 &lt;+185&gt;:	mov    0x2008f6(%rip),%eax        # 0x601050 &lt;max_add_end&gt;</span><br><span class="line">...</span><br><span class="line">(gdb) disassemble sum_till_max </span><br><span class="line">Dump of assembler code for function sum_till_max:</span><br><span class="line">   0x0000000000400666 &lt;+0&gt;: 	push   %rbp ---------------------------------------------------------#3</span><br><span class="line">   0x0000000000400667 &lt;+1&gt;: 	mov    %rsp,%rbp ----------------------------------------------------#4</span><br><span class="line">   0x000000000040066a &lt;+4&gt;: 	sub    $0x20,%rsp ---------------------------------------------------#5</span><br><span class="line">   0x000000000040066e &lt;+8&gt;: 	mov    %edi,-0x14(%rbp)</span><br><span class="line">   0x0000000000400671 &lt;+11&gt;:	addl   $0x1,-0x14(%rbp) ---------------------------------------------#6</span><br><span class="line">   0x0000000000400675 &lt;+15&gt;:	mov    -0x14(%rbp),%eax</span><br><span class="line">   0x0000000000400678 &lt;+18&gt;:	mov    %rax,-0x8(%rbp)</span><br><span class="line">   0x000000000040067c &lt;+22&gt;:	mov    0x2009ce(%rip),%eax        # 0x601050 &lt;max_add_end&gt;</span><br><span class="line">   0x0000000000400682 &lt;+28&gt;:	cmp    %eax,-0x14(%rbp)</span><br><span class="line">   0x0000000000400685 &lt;+31&gt;:	jae    0x400695 &lt;sum_till_max+47&gt;</span><br><span class="line">   0x0000000000400687 &lt;+33&gt;:	mov    -0x14(%rbp),%eax</span><br><span class="line">   0x000000000040068a &lt;+36&gt;:	mov    %eax,%edi</span><br><span class="line">   0x000000000040068c &lt;+38&gt;:	callq  0x400666 &lt;sum_till_max&gt;</span><br><span class="line">   0x0000000000400691 &lt;+43&gt;:	add    %rax,-0x8(%rbp)</span><br><span class="line">   0x0000000000400695 &lt;+47&gt;:	mov    -0x8(%rbp),%rax</span><br><span class="line">   0x0000000000400699 &lt;+51&gt;:	leaveq --------------------------------------------------------------#7</span><br><span class="line">   0x000000000040069a &lt;+52&gt;:	retq ----------------------------------------------------------------#8</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="https://manybutfinite.com/post/journey-to-the-stack/">journey to the stack</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions">x86 Disassembly/Calling Conventions</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/12/26/function-calling-conventions/" data-id="ckrqkh47c000q2ovlh60obocu" data-title="Function Calling Conventions" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/calling-conventions/" rel="tag">calling conventions</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-qemu-kvm" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/12/16/qemu-kvm/" class="article-date">
  <time class="dt-published" datetime="2018-12-16T07:34:14.000Z" itemprop="datePublished">2018-12-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/12/16/qemu-kvm/">KVM virtulization with Qemu</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Qemu-Threads"><a href="#Qemu-Threads" class="headerlink" title="Qemu Threads"></a>Qemu Threads</h3><ul>
<li>main thread: main_loop()/vl.c, main_loop_wait()/main-loop.c<ul>
<li>Waits for file descriptors to become readable or writable. File descriptors play a critical role because files, sockets, pipes, and various other resources are all file descriptors. File descriptors can be added using qemu_set_fd_handler().</li>
<li>Runs expired timers. Timers can be added using qemu_mod_timer().</li>
<li>Runs bottom-halves (BHs), which are like timers that expire immediately. BHs are used to avoid reentrancy and overflowing the call stack. BHs can be added using qemu_bh_schedule().</li>
</ul>
</li>
<li>io thread: iothread_run()</li>
<li>vcpu thread: qemu_kvm_cpu_thread_fn()</li>
</ul>
<h3 id="KVM-and-Qemu-Interaction-Diagram"><a href="#KVM-and-Qemu-Interaction-Diagram" class="headerlink" title="KVM and Qemu Interaction Diagram"></a>KVM and Qemu Interaction Diagram</h3><ul>
<li>KVM and Qemu Interaction Diagram<br><img src="kvm-qemu-interaction.png" alt="KVM and Qemu interaction diagram"></li>
</ul>
<h3 id="GuestOS-KVM-and-Qemu-Iteraction-Diagram-virtio-net"><a href="#GuestOS-KVM-and-Qemu-Iteraction-Diagram-virtio-net" class="headerlink" title="GuestOS, KVM and Qemu Iteraction Diagram: virtio-net"></a>GuestOS, KVM and Qemu Iteraction Diagram: virtio-net</h3><ul>
<li>GuestOS, KVM and Qemu Iteraction Diagram: virtio-net<br><img src="virtio-net.png" alt="GuestOS, KVM and Qemu Iteraction Diagram: virtio-net"></li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="http://blog.vmsplice.net/2011/03/qemu-internals-overall-architecture-and.html">QEMU Internals: Overall architecture and threading model</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/12/16/qemu-kvm/" data-id="ckrqkh48000202ovl4y9474i6" data-title="KVM virtulization with Qemu" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/kvm/" rel="tag">kvm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/qemu/" rel="tag">qemu</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/virtualization/" rel="tag">virtualization</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-memory-layout" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/11/16/memory-layout/" class="article-date">
  <time class="dt-published" datetime="2018-11-16T13:31:44.000Z" itemprop="datePublished">2018-11-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/11/16/memory-layout/">Memory Layout of C Programs</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>A typical memory representation of C program consists of following sections.</p>
<ol>
<li>Text segment</li>
<li>Initialized data segment</li>
<li>Uninitialized data segment</li>
<li>Stack</li>
<li>Heap</li>
</ol>
<p>A typical memory layout of a running process<br><img src="memory-layout.png" alt="A typical memory layout of a running process"></p>
<h3 id="Text-Segment"><a href="#Text-Segment" class="headerlink" title="Text Segment"></a>Text Segment</h3><p>A text segment , also known as a code segment or simply as text, is one of the sections of a program in an object file or in memory, which contains executable instructions.</p>
<p>As a memory region, a text segment may be placed below the heap or stack in order to prevent heaps and stack overflows from overwriting it.</p>
<p>Usually, the text segment is sharable so that only a single copy needs to be in memory for frequently executed programs, such as text editors, the C compiler, the shells, and so on. Also, the text segment is often read-only, to prevent a program from accidentally modifying its instructions.</p>
<h3 id="Initialized-Data-Segment"><a href="#Initialized-Data-Segment" class="headerlink" title="Initialized Data Segment"></a>Initialized Data Segment</h3><p>Initialized data segment, usually called simply the Data Segment. A data segment is a portion of virtual address space of a program, which contains the global variables and static variables that are initialized by the programmer.</p>
<p>Note that, data segment is not read-only, since the values of the variables can be altered at run time.</p>
<p>This segment can be further classified into initialized read-only area and initialized read-write area.</p>
<p>For instance the global string defined by char s[] = “hello world” in C and a C statement like int debug=1 outside the main (i.e. global) would be stored in initialized read-write area. And a global C statement like const char* string = “hello world” makes the string literal “hello world” to be stored in initialized read-only area and the character pointer variable string in initialized read-write area.</p>
<p>Ex: static int i = 10 will be stored in data segment and global int i = 10 will also be stored in data segment.</p>
<h3 id="Uninitialized-Data-Segment"><a href="#Uninitialized-Data-Segment" class="headerlink" title="Uninitialized Data Segment"></a>Uninitialized Data Segment</h3><p>Uninitialized data segment, often called the “bss” segment, named after an ancient assembler operator that stood for “block started by symbol.” Data in this segment is initialized by the kernel to arithmetic 0 before the program starts executing</p>
<p>uninitialized data starts at the end of the data segment and contains all global variables and static variables that are initialized to zero or do not have explicit initialization in source code.</p>
<p>For instance a variable declared static int i; would be contained in the BSS segment.<br>For instance a global variable declared int j; would be contained in the BSS segment.</p>
<h3 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h3><p>The stack area traditionally adjoined the heap area and grew the opposite direction; when the stack pointer met the heap pointer, free memory was exhausted. (With modern large address spaces and virtual memory techniques they may be placed almost anywhere, but they still typically grow opposite directions.)</p>
<p>The stack area contains the program stack, a LIFO structure, typically located in the higher parts of memory. On the standard PC x86 computer architecture it grows toward address zero; on some other architectures it grows the opposite direction. A “stack pointer” register tracks the top of the stack; it is adjusted each time a value is “pushed” onto the stack. The set of values pushed for one function call is termed a “stack frame”; A stack frame consists at minimum of a return address.</p>
<p>Stack, where automatic variables are stored, along with information that is saved each time a function is called. Each time a function is called, the address of where to return to and certain information about the caller’s environment, such as some of the machine registers, are saved on the stack. The newly called function then allocates room on the stack for its automatic and temporary variables. This is how recursive functions in C can work. Each time a recursive function calls itself, a new stack frame is used, so one set of variables doesn’t interfere with the variables from another instance of the function.</p>
<h3 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h3><p>Heap is the segment where dynamic memory allocation usually takes place.</p>
<p>The heap area begins at the end of the BSS segment and grows to larger addresses from there.The Heap area is managed by malloc, realloc, and free, which may use the brk and sbrk system calls to adjust its size (note that the use of brk/sbrk and a single “heap area” is not required to fulfill the contract of malloc/realloc/free; they may also be implemented using mmap to reserve potentially non-contiguous regions of virtual memory into the process’ virtual address space). The Heap area is shared by all shared libraries and dynamically loaded modules in a process.</p>
<p>The <a target="_blank" rel="noopener" href="https://linux.die.net/man/1/size">size(1)</a> command reports the sizes (in bytes) of the text, data, and bss segments.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><ul>
<li><p>Check the following simple C program</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">  </span><br><span class="line">int main(void) </span><br><span class="line">&#123; </span><br><span class="line">    return 0; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ubuntu@ip-172-31-42-139:~/coding$ gcc -O0 ./memory-layout.c -o memory-layout</span><br><span class="line">ubuntu@ip-172-31-42-139:~/coding$ size memory-layout</span><br><span class="line">   text	   data	    bss	    dec	    hex	filename</span><br><span class="line">   1099	    544	      8	   1651	    673	memory-layout</span><br></pre></td></tr></table></figure></li>
<li><p>Let us add one global variable in program, now check the size of bss (highlighted in red color)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">  </span><br><span class="line">int global; /* Uninitialized variable stored in bss*/</span><br><span class="line">  </span><br><span class="line">int main(void) </span><br><span class="line">&#123; </span><br><span class="line">    return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Let us add one static variable which is also stored in bss</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">  </span><br><span class="line">int global; /* Uninitialized variable stored in bss*/</span><br><span class="line">  </span><br><span class="line">int main(void) </span><br><span class="line">&#123; </span><br><span class="line">    static int i; /* Uninitialized static variable stored in bss */</span><br><span class="line">    return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Let us initialize the static variable which will then be stored in Data Segment (DS)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">  </span><br><span class="line">int global; /* Uninitialized variable stored in bss*/</span><br><span class="line">  </span><br><span class="line">int main(void) </span><br><span class="line">&#123; </span><br><span class="line">    static int i = 100; /* Initialized static variable stored in DS*/</span><br><span class="line">    return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Let us initialize the global variable which will then be stored in Data Segment (DS)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">  </span><br><span class="line">int global = 10; /* initialized global variable stored in DS*/</span><br><span class="line">  </span><br><span class="line">int main(void) </span><br><span class="line">&#123; </span><br><span class="line">    static int i = 100; /* Initialized static variable stored in DS*/</span><br><span class="line">    return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Heap-Details"><a href="#Heap-Details" class="headerlink" title="Heap Details"></a>Heap Details</h3><p>Heap Zoom In<br><img src="heap-zoom-in.png" alt="Heap Zoom In"><br>When malloc size is less than M_MMAP_THRESHOLD, which could set by mallopt(), brk() will be used, otherwise mmap() will be used. With brk() the memory blocks are not immediately returned to system, the C library aggregates them until a sufficiently large, contiguous chunk can be freed at once.</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a target="_blank" rel="noopener" href="https://en.m.wikibooks.org/wiki/X86_Assembly/X86_Architecture">x86 Architecture</a><br><a target="_blank" rel="noopener" href="https://www.linuxjournal.com/article/6390">Advanced Memory Allocation</a><br><a target="_blank" rel="noopener" href="https://manybutfinite.com/post/anatomy-of-a-program-in-memory/">Anatomy of a Program in Memory</a><br><a target="_blank" rel="noopener" href="https://manybutfinite.com/post/how-the-kernel-manages-your-memory/">How The Kernel Manages Your Memory</a><br><a target="_blank" rel="noopener" href="https://manybutfinite.com/post/memory-translation-and-segmentation/">Memory Translation and Segmentation</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/11/16/memory-layout/" data-id="ckrqkh47t001j2ovlffdyd7nw" data-title="Memory Layout of C Programs" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/memory-layout/" rel="tag">memory layout</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/program/" rel="tag">program</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-sas-sata" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/11/06/sas-sata/" class="article-date">
  <time class="dt-published" datetime="2018-11-06T14:31:44.000Z" itemprop="datePublished">2018-11-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/11/06/sas-sata/">ATA, SATA, SCSI and SAS</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Abbreviations"><a href="#Abbreviations" class="headerlink" title="Abbreviations"></a>Abbreviations</h3><table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Acronym for</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ATA, IDE</td>
<td align="left">Advanced Technology Attachment, Integrated Drive Electronics</td>
</tr>
<tr>
<td align="left">SATA</td>
<td align="left">Serial ATA</td>
</tr>
<tr>
<td align="left">SCSI</td>
<td align="left">Small Computer System Interface</td>
</tr>
<tr>
<td align="left">SAS</td>
<td align="left">Serial Attached SCSI</td>
</tr>
</tbody></table>
<h3 id="Standard-Committes"><a href="#Standard-Committes" class="headerlink" title="Standard Committes"></a>Standard Committes</h3><ul>
<li><a target="_blank" rel="noopener" href="http://www.incits.org/">incits</a>:  InterNational Committee for Information Technology Standards<ul>
<li><a target="_blank" rel="noopener" href="http://t10.org/">t10</a>: Technical Committee T10, SCSI Storage Interfaces</li>
<li><a target="_blank" rel="noopener" href="http://t13.org/">t13</a>: Technical Committee T13, ATA Interfaces</li>
<li><a target="_blank" rel="noopener" href="http://www.incits.org/committees/">committees</a></li>
</ul>
</li>
</ul>
<h3 id="Industry-Alliances"><a href="#Industry-Alliances" class="headerlink" title="Industry Alliances"></a>Industry Alliances</h3><ul>
<li><a target="_blank" rel="noopener" href="http://www.scsita.org/content/">SCSI Trade Alliance</a></li>
</ul>
<h3 id="Roadmaps"><a href="#Roadmaps" class="headerlink" title="Roadmaps"></a>Roadmaps</h3><ul>
<li>SAS Roadmap<br><img src="SAS_roadmap.jpg" alt="SAS Roadmap"></li>
</ul>
<h3 id="Compare"><a href="#Compare" class="headerlink" title="Compare"></a>Compare</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.webopedia.com/DidYouKnow/Computer_Science/sas_sata.asp">SAS, SATA, SCSI and ATA</a></li>
<li>SAS vs SATA: reliability, error bit rate, MTBF, error recovery/detection, silent data corruption, RV compensation feedback mechanism <ul>
<li><a target="_blank" rel="noopener" href="https://www.intel.com/content/www/us/en/support/articles/000005782/server-products.html">Intel</a></li>
<li><a target="_blank" rel="noopener" href="https://www.diffen.com/difference/SATA_vs_Serial_Attached_SCSI#SATA_and_SATA_Revisions">Diffen</a></li>
<li><a target="_blank" rel="noopener" href="http://www.enterprisestorageforum.com/storage-networking/sas-vs-sata.html">EnterpriseStorageForum</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.computerworld.com/article/2574104/data-center/serial-vs--parallel-storage.html">Serial vs Parallel</a>: signal skewing, crosstalk</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/11/06/sas-sata/" data-id="ckrqkh48800262ovl0u5t9neh" data-title="ATA, SATA, SCSI and SAS" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/interface/" rel="tag">interface</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/storage/" rel="tag">storage</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-linux-weather-forecast" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/10/03/linux-weather-forecast/" class="article-date">
  <time class="dt-published" datetime="2018-10-03T14:25:59.000Z" itemprop="datePublished">2018-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/quotes/">quotes</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/10/03/linux-weather-forecast/">Collection of Linux Weather Forcast</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.linux.com/news/category/linux-kernel">Weather Forcast</a></p>
<h3 id="Short-term-Forcast"><a href="#Short-term-Forcast" class="headerlink" title="Short-term Forcast"></a>Short-term Forcast</h3><ul>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/748879/">Time-based packet transmission</a></li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/758353/">CAKE queueing discipline</a>: offers significantly better networking performance, especially in home or small-business settings.</li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/758963/">The block I/O latency controller</a>: allows an administrator to provide block (disk) I/O response-time guarantees to specific processes.</li>
</ul>
<h3 id="Kernel-4-18"><a href="#Kernel-4-18" class="headerlink" title="Kernel-4.18"></a>Kernel-4.18</h3><ul>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/747551/">bpfilter</a>: expected to be the base on which the next generation of kernel firewalling systems is built.</li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/754681/">A reworked TCP zero-copy receive API</a></li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/750845/">Accelerating networking with AF_XDP</a>: a larger effort to win back users of user-space networking stacks by providing better facilities in the kernel.</li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/760690/">Statistics from the 4.18 development cycle</a></li>
<li><a target="_blank" rel="noopener" href="https://www.linux.com/news/2018/9/linux-weather-forecast">Linux Weather Forecast 2018.09</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/10/03/linux-weather-forecast/" data-id="ckrqkh47o001f2ovl5j6fb5u9" data-title="Collection of Linux Weather Forcast" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/kernel/" rel="tag">kernel</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-gcloud-share" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/09/28/gcloud-share/" class="article-date">
  <time class="dt-published" datetime="2018-09-28T15:17:26.000Z" itemprop="datePublished">2018-09-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/quotes/">quotes</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/09/28/gcloud-share/">Google Driver for Linux</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h3><p>To share directory between windows and linux enviroment with <a target="_blank" rel="noopener" href="https://drive.google.com/drive/my-drive">Google Driver</a>. The most important reason to choose google driver is  the compabiltiy of driver client span OS, such as Linux, Windows, macOS, iOS and Android.</p>
<h3 id="Top-12-Best-Google-Drive-Linux-Client-Software"><a href="#Top-12-Best-Google-Drive-Linux-Client-Software" class="headerlink" title="Top 12 Best Google Drive Linux Client Software"></a><a target="_blank" rel="noopener" href="https://www.ubuntupit.com/top-12-best-google-drive-linux-client-software/">Top 12 Best Google Drive Linux Client Software</a></h3><ul>
<li>GUI Tools: <a target="_blank" rel="noopener" href="https://www.insynchq.com/">Insync</a></li>
<li>Command Line Tools: <a target="_blank" rel="noopener" href="http://yourcmc.ru/wiki/Grive2">grive2</a>, <a target="_blank" rel="noopener" href="https://github.com/astrada/google-drive-ocamlfuse">google-drive-ocamlfuse</a></li>
</ul>
<h3 id="Grive2-Install-Steps"><a href="#Grive2-Install-Steps" class="headerlink" title="Grive2 Install Steps"></a>Grive2 Install Steps</h3><ul>
<li><p>For CentOS 7.4</p>
<ul>
<li># yum -y groupinstall “Development Tools”</li>
<li># yum -y install git cmake libgcrypt-devel yajl yajl-devel boost boost-devel curl curl-devel expat-devel cppunit-devel binutils-devel pkgconfig zlib-devel</li>
</ul>
</li>
<li><p>For Ubuntu 16.04</p>
<ul>
<li># sudo apt-get update; sudo apt-get upgrade; sudo apt-get install build-essential</li>
<li># sudo apt-get install git cmake build-essential libgcrypt11-dev libyajl-dev libboost-all-dev libcurl4-openssl-dev libexpat1-dev libcppunit-dev binutils-dev debhelper  zlib1g-dev dpkg-dev pkg-config</li>
</ul>
</li>
<li><p>The Next Steps, <a target="_blank" rel="noopener" href="http://yourcmc.ru/wiki/Grive2#Download_sources">grive2 wiki</a>, or the <a target="_blank" rel="noopener" href="https://github.com/vitalif/grive2">grive2 github</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/09/28/gcloud-share/" data-id="ckrqkh47f000x2ovl5vv2g0he" data-title="Google Driver for Linux" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/Driver/" rel="tag">Driver</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/tool/" rel="tag">tool</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-vim" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/09/08/vim/" class="article-date">
  <time class="dt-published" datetime="2018-09-08T13:17:05.000Z" itemprop="datePublished">2018-09-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/quotes/">quotes</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/09/08/vim/">Learn Vim</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Vim-Modes"><a href="#Vim-Modes" class="headerlink" title="Vim Modes"></a>Vim Modes</h3><ul>
<li>Vim modes switch<br><img src="vim-modes.png" alt="Vim Modes Switch"></li>
<li>Remap &lt;Esc&gt; key, changing <a target="_blank" rel="noopener" href="http://learnvimscriptthehardway.stevelosh.com/chapters/06.html">the leader key</a><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># cat ~/.vimrc </span><br><span class="line">inoremap jk &lt;Esc&gt;</span><br><span class="line">let mapleader=&quot;&lt;Space&gt;&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Free-Online-Resources-to-Learn-Vim"><a href="#Free-Online-Resources-to-Learn-Vim" class="headerlink" title="Free Online Resources to Learn Vim"></a>Free Online Resources to Learn Vim</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.vim.org/">vim</a>, vimtutor</li>
<li><a target="_blank" rel="noopener" href="https://www.openvim.com/">openvim</a></li>
<li><a target="_blank" rel="noopener" href="http://vimcasts.org/">vimcasts</a></li>
<li><a target="_blank" rel="noopener" href="http://www.vimgenius.com/">vim genius</a></li>
<li><a target="_blank" rel="noopener" href="https://vim.rtorr.com/">vim cheet sheet</a></li>
<li><a target="_blank" rel="noopener" href="https://www.vim.org/scripts/script.php?script_id=3409">HJKL-learning game</a></li>
<li><a target="_blank" rel="noopener" href="https://vim-adventures.com/">vim-adventures game</a></li>
</ul>
<h3 id="Vedios-and-Blogs"><a href="#Vedios-and-Blogs" class="headerlink" title="Vedios and Blogs"></a>Vedios and Blogs</h3><ul>
<li><a target="_blank" rel="noopener" href="http://derekwyatt.org/vim/tutorials/index.html">vim vedios</a></li>
<li><a target="_blank" rel="noopener" href="https://vimeo.com/search?q=welcom+to+vim">basics of vim</a></li>
<li><a target="_blank" rel="noopener" href="https://www.labnol.org/internet/learning-vim-for-beginners/28820/">Learning Vim for Beginners</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/actualize-network/how-to-learn-vim-a-four-week-plan-cd8b376a9b85">How To Learn Vim: A Four Week Plan</a></li>
</ul>
<h3 id="Frequent-Commands"><a href="#Frequent-Commands" class="headerlink" title="Frequent Commands"></a>Frequent Commands</h3><ul>
<li>One line<ul>
<li>Ctrl+Y → Move viewport down</li>
<li>Ctrl+E → Move viewport up (Extra lines)</li>
</ul>
</li>
<li>Full screen<ul>
<li>Ctrl+F → Move viewport Forward</li>
<li>Ctrl+B → Move viewport Backward</li>
</ul>
</li>
<li>Half a screen<ul>
<li>Ctrl+U → Move viewport Up</li>
<li>Ctrl+D → Move viewport Down</li>
</ul>
</li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="https://danielmiessler.com/study/vim/">A vim Tutorial and Primer</a></li>
<li><a target="_blank" rel="noopener" href="http://learnvimscriptthehardway.stevelosh.com/">Learn Vimscript the Hard Way</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/09/08/vim/" data-id="ckrqkh48e002l2ovlc6u53xfh" data-title="Learn Vim" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/tool/" rel="tag">tool</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/vim/" rel="tag">vim</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-netfilter" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/09/07/netfilter/" class="article-date">
  <time class="dt-published" datetime="2018-09-07T13:13:41.000Z" itemprop="datePublished">2018-09-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/09/07/netfilter/">Netfilter Framework</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://ipset.netfilter.org/">IP sets</a>, <a target="_blank" rel="noopener" href="http://www.linuxvirtualserver.org/">ipvs</a> all based on the Linux kernel <a target="_blank" rel="noopener" href="https://www.netfilter.org/">netfilter</a> subsystem.</p>
<h3 id="Key-Structures-Variables-and-Functions"><a href="#Key-Structures-Variables-and-Functions" class="headerlink" title="Key Structures, Variables and Functions"></a>Key Structures, Variables and Functions</h3><ul>
<li>net/netfilter/core.c: <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_hooks_needed">struct static_key <em>nf_hooks_needed[][]</em></a>, in the old kernel version <em>nf_hooks[][]</em> is defined.</li>
<li>include/uapi/linux/netfilter.h: <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_inet_hooks">enum <em>nf_inet_hooks</em></a></li>
<li>include/uapi/linux/netfilter.h: <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/NFPROTO_NUMPROTO"><em>NFPROTO_NUMPROTO</em></a></li>
<li>include/uapi/linux/netfilter_ipv4.h: <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_ip_hook_priorities">enum <em>nf_iphook_priorities</em></a>, list the most common tables(priority from high to low):<ul>
<li>NF_IP_PRI_RAW(-300), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/packet_raw">packet_raw</a></li>
<li>NF_IP_PRI_CONNTRACK(-200), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_conntrack_l3proto_ipv4_init">nf_conntrack_l3proto_ipv4_init</a>, <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ipv4_conntrack_ops">ipv4_conntrack_ops</a></li>
<li>NF_IP_PRI_MANGLE(-150), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/packet_mangler">packet_mangler</a></li>
<li>NF_IP_PRI_NAT_DST(-100), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_nat_ipv4_table">nf_nat_ipv4_table</a>, <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_nat_ipv4_ops">nf_nat_ipv4_ops</a></li>
<li>NF_IP_PRI_FILTER(0), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/packet_filter">packet_filter</a></li>
<li>NF_IP_PRI_NAT_SRC(100), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_nat_ipv4_table">nf_nat_ipv4_table</a>, <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_nat_ipv4_ops">nf_nat_ipv4_ops</a></li>
<li>NF_IP_PRI_CONNTRACK_HELPER(300), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ipv4_conntrack_ops">ipv4_conntrack_ops</a></li>
<li>NF_IP_PRI_CONNTRACK_CONFIRM(INT_MAX), <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ipv4_conntrack_ops">ipv4_conntrack_ops</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/NF_HOOK"><em>NF_HOOK()</em></a></li>
<li><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ipt_register_table"><em>ipt_register_table()</em></a></li>
<li><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/nf_register_net_hook"><em>nf_register_net_hook()</em></a>, in the old kernel version <em>nf_register_hook</em> is defined.</li>
</ul>
<h3 id="Netfilter-Hooks-and-Tables"><a href="#Netfilter-Hooks-and-Tables" class="headerlink" title="Netfilter Hooks and Tables"></a>Netfilter Hooks and Tables</h3><ul>
<li><p>Netfilter Hooks in Kernel<br><img src="hooks-in-kernel.png" alt="Netfilter Hooks in Kernel"></p>
</li>
<li><p>Tables in Netfilter Hooks<br><img src="tables-in-hook.png" alt="Tables in Netfilter Hooks"><br>Note: Dnat table in LOCAL_OUT actually is POST_RETOUING, but after modifty destination address/port called <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ip_route_me_harder"><em>ip_route_me_harder()</em></a>, used by iptable_nat and iptable_mangle + ip_queue, in <em>function nf_nat_ipv4_local_fn()</em>.</p>
</li>
<li><p>Detail of Connection Tracking Hooks<br><img src="conntrack-hooks.png" alt="Detail of Connection Tracking Hooks"><br>For packet received, routing decision is done by <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/ip_mkroute_input"><em>ip_mkroute_input()</em></a> called by <em>ip_rcv_finish()</em>, while the local out packet routing is <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/ident/__mkroute_output"><em>__mkroute_output()</em></a>.</p>
</li>
<li><p>Transport Layer Trace(CentOS 7.4.1708 kernel-3.10.0.693)<br>inet_init(): struct net_protocol inet_protos[MAX_INET_PROTOS], e.g. udp_protocol, tcp_protocol, igmp_protocol, icmp_protocol.</p>
<ul>
<li>UDP receive path:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ip_rcv_finish() --&gt; ip_route_input_slow() --&gt;ip_route_input_slow()</span><br><span class="line">	--&gt; forward: ip_mkroute_input() --&gt; rth-&gt;dst.input = ip_forward;</span><br><span class="line">	--&gt; local_input: rth-&gt;dst.input= ip_local_deliver; </span><br><span class="line">		--&gt; skb_dst(skb)-&gt;input() --&gt; ip_local_deliver() --&gt; ip_local_deliver_finish() --&gt; ipprot-&gt;handler()</span><br><span class="line">			--&gt; udp_rcv() --&gt; __udp4_lib_rcv() --&gt; udp_queue_rcv_skb() --&gt; __udp_enqueue_schedule_skb() --&gt; sk-&gt;sk_data_ready() --&gt; sock_def_readable()</span><br><span class="line">				--&gt;__wake_up_common() --&gt; curr-&gt;func() --&gt; default_wake_function() --&gt; try_to_wake_up() --&gt; ttwu_queue()</span><br></pre></td></tr></table></figure></li>
<li>UDP send path:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">udp_sendmsg() --&gt; ip_route_output_flow() --&gt; (struct xfrm_policy_afinfo *) -&gt;dst_lookup() --&gt; struct xfrm_policy_afinfo xfrm4_policy_afinfo</span><br><span class="line">	--&gt; xfrm4_dst_lookup() --&gt; __ip_route_output_key() --&gt; __mkroute_output()</span><br><span class="line">		--&gt; rth-&gt;dst.input = ip_local_deliver;</span><br><span class="line">		--&gt; rth-&gt;dst.output = ip_output;</span><br><span class="line">			--&gt; udp_send_skb() --&gt; ip_local_out() --&gt; ip_output()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="Userspace-Tools"><a href="#Userspace-Tools" class="headerlink" title="Userspace Tools"></a>Userspace Tools</h3><ul>
<li>iptables, ip6tables, arptables, ebtables</li>
<li><a target="_blank" rel="noopener" href="https://lwn.net/Articles/564095/">nftables</a></li>
<li>bpfilter, <a target="_blank" rel="noopener" href="https://lwn.net/Articles/747551/">BPF comes to firewalls</a></li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li>Linux Kernel Networking: Implemetation and Theory</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/09/07/netfilter/" data-id="ckrqkh47u001m2ovl807wh846" data-title="Netfilter Framework" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/kernel/" rel="tag">kernel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/netfilter/" rel="tag">netfilter</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ovs-conntrack" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/leptons-bosons/2018/09/02/ovs-conntrack/" class="article-date">
  <time class="dt-published" datetime="2018-09-02T11:20:00.000Z" itemprop="datePublished">2018-09-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/leptons-bosons/categories/original/">original</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/leptons-bosons/2018/09/02/ovs-conntrack/">Open vSwitch Conntrack</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>OVS can be used with the Connection tracking system where OpenFlow flow can be used to match on the state of a TCP, UDP, ICMP, etc., connections. (Connection tracking system supports tracking of both statefull and stateless protocols)</p>
<h3 id="Match-Fields"><a href="#Match-Fields" class="headerlink" title="Match Fields"></a>Match Fields</h3><ul>
<li><strong>ct_state</strong>: new, est, rel, rpl, inv, trk, snat, dnat</li>
<li><strong>ct_zone</strong>: A zone is an independent connection tracking context which can be set by a ct action. A 16-bit ct_zone set by the most recent ct action (by an OpenFlow flow on a conntrack entry) can be used as a match field in another flow entry.</li>
<li><strong>ct_mark</strong>: The 32-bit metadata committed, by an action within the exec parameter to the ct action, to the connection to which the current packet belongs.</li>
<li><strong>ct_label</strong>: The 128-bit label committed by an action within the exec parameter to the ct action, to the connection to which the current packet belongs.</li>
<li><strong>ct_nw_src/ct_ipv6_src</strong>: Matches IPv4/IPv6 conntrack original direction tuple source address.</li>
<li><strong>ct_nw_dst/ct_ipv6_dst</strong>: Matches IPv4/IPv6 conntrack original direction tuple destination address.</li>
<li><strong>ct_nw_proto</strong>: Matches conntrack original direction tuple IP protocol type.</li>
<li><strong>ct_tp_src</strong>: Matches on the conntrack original direction tuple transport source port.</li>
<li><strong>ct_tp_dst</strong>: Matches on the conntrack original direction tuple transport destination port.</li>
</ul>
<h3 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h3><ul>
<li><strong>commit</strong>: Commit the connection to the connection tracking module which will be stored beyond the lifetime of packet in the pipeline.</li>
<li><strong>force</strong>: The force flag may be used in addition to commit flag to effectively terminate the existing connection and start a new one in the current direction.</li>
<li><strong>table=number</strong>: Fork pipeline processing in two. The original instance of the packet will continue processing the current actions list as an untracked packet. An additional instance of the packet will be sent to the connection tracker, which will be re-injected into the OpenFlow pipeline to resume processing in table number, with the ct_state and other ct match fields set.</li>
<li><strong>zone=value OR zone=src[start..end]</strong>: A 16-bit context id that can be used to isolate connections into separate domains, allowing over‐lapping network addresses in different zones. If a zone is not provided, then the default is to use zone zero.</li>
<li>exec([action][,action…])**: Perform restricted set of actions within the context of connection tracking. Only actions which modify the ct_mark or ct_label fields are accepted within the exec action.</li>
<li><strong>alg=&lt;ftp/tftp&gt;</strong>: Specify alg (application layer gateway) to track specific connection types.</li>
<li><strong>nat</strong>: Specifies the address and port translation for the connection being tracked.</li>
</ul>
<h3 id="Setup-Enviroment"><a href="#Setup-Enviroment" class="headerlink" title="Setup Enviroment"></a>Setup Enviroment</h3><ul>
<li><p>Topology for conntrack testing<br><img src="ovs-conntrack-bridge.png" alt="Topology for conntrack testing"></p>
</li>
<li><p>Start openvswitch service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/local/share/openvswitch/scripts/ovs-ctl start</span><br></pre></td></tr></table></figure></li>
<li><p>Create bridge, namespace and port</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ ip netns add left</span><br><span class="line">$ ip netns add right</span><br><span class="line">$</span><br><span class="line">$ ip link add veth_l0 type veth peer name veth_l1</span><br><span class="line">$ ip link set veth_l1 netns left</span><br><span class="line">$ ip link add veth_r0 type veth peer name veth_r1</span><br><span class="line">$ ip link set veth_r1 netns right</span><br><span class="line">$</span><br><span class="line">$ ovs-vsctl add-br br0</span><br><span class="line">$ ovs-vsctl add-port br0 veth_l0</span><br><span class="line">$ ovs-vsctl add-port br0 veth_r0</span><br></pre></td></tr></table></figure></li>
<li><p>Add flows</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=10, in_port=veth_l0, actions=veth_r0&quot;</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=10, in_port=veth_r0, actions=veth_l0&quot;</span><br><span class="line">$</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">   &quot;table=0, priority=50, ct_state=-trk, tcp, in_port=veth_l0, actions=ct(table=0)&quot;</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=50, ct_state=+new, tcp, in_port=veth_l0, actions=ct(commit),veth_r0&quot;</span><br><span class="line">$</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=50, ct_state=-trk, tcp, in_port=veth_r0, actions=ct(table=0)&quot;</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=50, ct_state=+est, tcp, in_port=veth_r0, actions=veth_l0&quot;</span><br><span class="line">$</span><br><span class="line">$ ovs-ofctl add-flow br0 \</span><br><span class="line">    &quot;table=0, priority=50, ct_state=+est, tcp, in_port=veth_l0, actions=veth_r0&quot;</span><br><span class="line">$</span><br><span class="line"># ovs-ofctl dump-flows br0</span><br><span class="line"> cookie=0x0, duration=1405.483s, table=0, n_packets=0, n_bytes=0, priority=50,ct_state=-trk,tcp,in_port=&quot;veth_l0&quot; actions=ct(table=0)</span><br><span class="line"> cookie=0x0, duration=43.364s, table=0, n_packets=0, n_bytes=0, priority=50,ct_state=-trk,tcp,in_port=&quot;veth_r0&quot; actions=ct(table=0)</span><br><span class="line"> cookie=0x0, duration=59.531s, table=0, n_packets=0, n_bytes=0, priority=50,ct_state=+new,tcp,in_port=&quot;veth_l0&quot; actions=ct(commit),output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=33.071s, table=0, n_packets=0, n_bytes=0, priority=50,ct_state=+est,tcp,in_port=&quot;veth_r0&quot; actions=output:&quot;veth_l0&quot;</span><br><span class="line"> cookie=0x0, duration=20.592s, table=0, n_packets=0, n_bytes=0, priority=50,ct_state=+est,tcp,in_port=&quot;veth_l0&quot; actions=output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=1423.495s, table=0, n_packets=0, n_bytes=0, priority=10,in_port=&quot;veth_l0&quot; actions=output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=1414.843s, table=0, n_packets=0, n_bytes=0, priority=10,in_port=&quot;veth_r0&quot; actions=output:&quot;veth_l0&quot;</span><br><span class="line"> cookie=0x0, duration=1448.989s, table=0, n_packets=0, n_bytes=0, priority=0 actions=NORMAL</span><br></pre></td></tr></table></figure></li>
<li><p>Install <a target="_blank" rel="noopener" href="https://scapy.net/">scapy</a>, <a target="_blank" rel="noopener" href="https://scapy.readthedocs.io/en/latest/installation.html">installation guide</a></p>
</li>
<li><p>Send packet with scapy, connection setup, transfer data, and connection teardown.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ip netns exec left sudo ip link set lo up</span><br><span class="line">$ sudo ip netns exec left sudo ip link set veth_l1 up</span><br><span class="line">$ sudo ip netns exec right sudo ip link set lo up</span><br><span class="line">$ sudo ip netns exec right sudo ip link set veth_r1 up</span><br><span class="line">$ sudo ifconfig veth_l0 up</span><br><span class="line">$ sudo ifconfig veth_r0 up</span><br><span class="line"></span><br><span class="line">$ sudo ip netns exec left sudo `which scapy`</span><br><span class="line">$ sudo ip netns exec right sudo `which scapy`</span><br><span class="line">$</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;192.168.0.2&quot;, dst=&quot;10.0.0.2&quot;)/TCP(sport=1024, dport=2048, flags=0x02, seq=100), iface=&quot;veth_l1&quot;)</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;10.0.0.2&quot;, dst=&quot;192.168.0.2&quot;)/TCP(sport=2048, dport=1024, flags=0x12, seq=200, ack=101), iface=&quot;veth_r1&quot;)</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;192.168.0.2&quot;, dst=&quot;10.0.0.2&quot;)/TCP(sport=1024, dport=2048, flags=0x10, seq=101, ack=201), iface=&quot;veth_l1&quot;)</span><br><span class="line">$</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;192.168.0.2&quot;, dst=&quot;10.0.0.2&quot;)/TCP(sport=1024, dport=2048, flags=0x10, seq=101, ack=201)/&quot;X&quot;, iface=&quot;veth_l1&quot;)</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;10.0.0.2&quot;, dst=&quot;192.168.0.2&quot;)/TCP(sport=2048, dport=1024, flags=0X10, seq=201, ack=102), iface=&quot;veth_r1&quot;)</span><br><span class="line">$</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;192.168.0.2&quot;, dst=&quot;10.0.0.2&quot;)/TCP(sport=1024, dport=2048, flags=0x11, seq=102, ack=201), iface=&quot;veth_l1&quot;)</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;10.0.0.2&quot;, dst=&quot;192.168.0.2&quot;)/TCP(sport=2048, dport=1024, flags=0X11, seq=201, ack=103), iface=&quot;veth_r1&quot;)</span><br><span class="line">$ &gt;&gt;&gt; sendp(Ether()/IP(src=&quot;192.168.0.2&quot;, dst=&quot;10.0.0.2&quot;)/TCP(sport=1024, dport=2048, flags=0x10, seq=103, ack=202), iface=&quot;veth_l1&quot;)</span><br></pre></td></tr></table></figure></li>
<li><p>Monitor the conntrack and flow changes</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=SYN_SENT)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=ESTABLISHED)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=ESTABLISHED)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=ESTABLISHED)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=ESTABLISHED)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=FIN_WAIT_1)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=LAST_ACK)</span><br><span class="line"># ovs-appctl dpctl/dump-conntrack | grep 1024</span><br><span class="line">tcp,orig=(src=192.168.0.2,dst=10.0.0.2,sport=1024,dport=2048),reply=(src=10.0.0.2,dst=192.168.0.2,sport=2048,dport=1024),protoinfo=(state=TIME_WAIT)</span><br><span class="line">$</span><br><span class="line"># ovs-appctl dpctl/dump-flows</span><br><span class="line">recirc_id(0),in_port(3),ct_state(-trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:ct,recirc(0xa)</span><br><span class="line">recirc_id(0xa),in_port(3),ct_state(-new+est+trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:2</span><br><span class="line"># ovs-appctl dpctl/dump-flows</span><br><span class="line">recirc_id(0xb),in_port(2),ct_state(-new+est+trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:3</span><br><span class="line">recirc_id(0),in_port(2),ct_state(-trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:ct,recirc(0xb)</span><br><span class="line"># ovs-appctl dpctl/dump-flows</span><br><span class="line">recirc_id(0xd),in_port(3),ct_state(-new+est+trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:2</span><br><span class="line">recirc_id(0),in_port(3),ct_state(-trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:ct,recirc(0xd)</span><br><span class="line"># ovs-appctl dpctl/dump-flows</span><br><span class="line">recirc_id(0xf),in_port(3),ct_state(-new+est+trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:2</span><br><span class="line">recirc_id(0),in_port(3),ct_state(-trk),eth(),eth_type(0x0800),ipv4(proto=6,frag=no), packets:0, bytes:0, used:never, actions:ct,recirc(0xf)</span><br><span class="line">$</span><br><span class="line"># ovs-ofctl dump-flows br0</span><br><span class="line"> cookie=0x0, duration=2676.690s, table=0, n_packets=8, n_bytes=434, priority=50,ct_state=-trk,tcp,in_port=&quot;veth_l0&quot; actions=ct(table=0)</span><br><span class="line"> cookie=0x0, duration=1314.571s, table=0, n_packets=4, n_bytes=216, priority=50,ct_state=-trk,tcp,in_port=&quot;veth_r0&quot; actions=ct(table=0)</span><br><span class="line"> cookie=0x0, duration=1330.738s, table=0, n_packets=2, n_bytes=108, priority=50,ct_state=+new,tcp,in_port=&quot;veth_l0&quot; actions=ct(commit),output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=1304.278s, table=0, n_packets=4, n_bytes=216, priority=50,ct_state=+est,tcp,in_port=&quot;veth_r0&quot; actions=output:&quot;veth_l0&quot;</span><br><span class="line"> cookie=0x0, duration=1291.799s, table=0, n_packets=6, n_bytes=326, priority=50,ct_state=+est,tcp,in_port=&quot;veth_l0&quot; actions=output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=2694.702s, table=0, n_packets=8, n_bytes=648, priority=10,in_port=&quot;veth_l0&quot; actions=output:&quot;veth_r0&quot;</span><br><span class="line"> cookie=0x0, duration=2686.050s, table=0, n_packets=8, n_bytes=648, priority=10,in_port=&quot;veth_r0&quot; actions=output:&quot;veth_l0&quot;</span><br><span class="line"> cookie=0x0, duration=2720.196s, table=0, n_packets=0, n_bytes=0, priority=0 actions=NORMA</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Shorten-Packet-Path-in-Openstack-with-conntrack-support"><a href="#Shorten-Packet-Path-in-Openstack-with-conntrack-support" class="headerlink" title="Shorten Packet Path in Openstack with conntrack support"></a>Shorten Packet Path in Openstack with conntrack support</h3><ul>
<li>Ovs in Openstack without conntrack support<br><img src="old-ovs-in-openstack.png" alt="Ovs in Openstack without conntrack support"></li>
<li>Ovs in Openstack with conntrack support<br><img src="new-ovs-conntract.png" alt="Ovs in Openstack with conntrack support"></li>
<li>Query conntrack info in kernel<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/net/nf_conntrack</span><br><span class="line">$ cat /proc/sys/net/nf_conntrack_max</span><br><span class="line">$ nstat</span><br><span class="line">$ cat /proc/net/snmp</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="http://docs.openvswitch.org/en/latest/intro/install/general/">Open vSwitch on Linux</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.openvswitch.org/en/latest/tutorials/ovs-conntrack/">Open vSwitch Conntrack</a></li>
<li><a target="_blank" rel="noopener" href="https://redhatstackblog.redhat.com/2016/07/22/how-connection-tracking-in-open-vswitch-helps-openstack-performance/">How connection tracking in Open vSwitch helps OpenStack performance</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://username.github.io/leptons-bosons/2018/09/02/ovs-conntrack/" data-id="ckrqkh47w001r2ovl4o4j4t8w" data-title="Open vSwitch Conntrack" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/Open-vSwitch/" rel="tag">Open vSwitch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/leptons-bosons/tags/conntrack/" rel="tag">conntrack</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/leptons-bosons/">&laquo; Prev</a><a class="page-number" href="/leptons-bosons/">1</a><span class="page-number current">2</span><a class="page-number" href="/leptons-bosons/page/3/">3</a><a class="page-number" href="/leptons-bosons/page/4/">4</a><a class="extend next" rel="next" href="/leptons-bosons/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/leptons-bosons/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/leptons-bosons/categories/original/">original</a></li><li class="category-list-item"><a class="category-list-link" href="/leptons-bosons/categories/quotes/">quotes</a></li><li class="category-list-item"><a class="category-list-link" href="/leptons-bosons/categories/reference/">reference</a></li><li class="category-list-item"><a class="category-list-link" href="/leptons-bosons/categories/virtualization/">virtualization</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Driver/" rel="tag">Driver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/EDK2/" rel="tag">EDK2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Infrastructure-Architecture/" rel="tag">Infrastructure Architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/KVM/" rel="tag">KVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Open-vSwitch/" rel="tag">Open vSwitch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/OpenStack/" rel="tag">OpenStack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Path-MTU/" rel="tag">Path MTU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Qemu/" rel="tag">Qemu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/Raspberry-Pi/" rel="tag">Raspberry Pi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/aarch64/" rel="tag">aarch64</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/acceleration/" rel="tag">acceleration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/analyst/" rel="tag">analyst</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/association/" rel="tag">association</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/aws-nitro/" rel="tag">aws nitro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/binary-index-tree/" rel="tag">binary index tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/binary-search/" rel="tag">binary search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/block-io/" rel="tag">block io</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/bookmark/" rel="tag">bookmark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/breadth-first-search/" rel="tag">breadth-first search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/bridge/" rel="tag">bridge</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/calling-conventions/" rel="tag">calling conventions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/conntrack/" rel="tag">conntrack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/design-patterns/" rel="tag">design patterns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/dijkstra/" rel="tag">dijkstra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/dynamic-programing/" rel="tag">dynamic programing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/ethernet/" rel="tag">ethernet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/expert/" rel="tag">expert</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/fenwick-tree/" rel="tag">fenwick tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/fibre-channel/" rel="tag">fibre channel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/flow-offload/" rel="tag">flow offload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/flow-table/" rel="tag">flow table</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/graph/" rel="tag">graph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/greedy/" rel="tag">greedy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/hardware/" rel="tag">hardware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/industry/" rel="tag">industry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/infiniband/" rel="tag">infiniband</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/interface/" rel="tag">interface</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/k-nearest-neighbors/" rel="tag">k-nearest-neighbors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/kernel/" rel="tag">kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/kvm/" rel="tag">kvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/memory-layout/" rel="tag">memory layout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/more-algorithms/" rel="tag">more algorithms</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/netfilter/" rel="tag">netfilter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/netlink/" rel="tag">netlink</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/network/" rel="tag">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/nic/" rel="tag">nic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/ofprot-trace/" rel="tag">ofprot/trace</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/ovs-sandbox/" rel="tag">ovs-sandbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/paper/" rel="tag">paper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/pcie/" rel="tag">pcie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/program/" rel="tag">program</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/protocol/" rel="tag">protocol</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/protocols/" rel="tag">protocols</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/qemu/" rel="tag">qemu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/quick-sort/" rel="tag">quick sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/segment-tree/" rel="tag">segment tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/selection-sort/" rel="tag">selection sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/shortest-path/" rel="tag">shortest path</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/simple-search/" rel="tag">simple search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/storage/" rel="tag">storage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/tcp-syn/" rel="tag">tcp syn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/tcp-ip/" rel="tag">tcp/ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/uml/" rel="tag">uml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/virtualization/" rel="tag">virtualization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/website/" rel="tag">website</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/wubi/" rel="tag">wubi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/leptons-bosons/tags/x86-64/" rel="tag">x86_64</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/leptons-bosons/tags/Driver/" style="font-size: 10px;">Driver</a> <a href="/leptons-bosons/tags/EDK2/" style="font-size: 10px;">EDK2</a> <a href="/leptons-bosons/tags/Infrastructure-Architecture/" style="font-size: 10px;">Infrastructure Architecture</a> <a href="/leptons-bosons/tags/KVM/" style="font-size: 10px;">KVM</a> <a href="/leptons-bosons/tags/Open-vSwitch/" style="font-size: 17.5px;">Open vSwitch</a> <a href="/leptons-bosons/tags/OpenStack/" style="font-size: 10px;">OpenStack</a> <a href="/leptons-bosons/tags/Path-MTU/" style="font-size: 10px;">Path MTU</a> <a href="/leptons-bosons/tags/Qemu/" style="font-size: 10px;">Qemu</a> <a href="/leptons-bosons/tags/Raspberry-Pi/" style="font-size: 10px;">Raspberry Pi</a> <a href="/leptons-bosons/tags/aarch64/" style="font-size: 10px;">aarch64</a> <a href="/leptons-bosons/tags/acceleration/" style="font-size: 10px;">acceleration</a> <a href="/leptons-bosons/tags/algorithm/" style="font-size: 20px;">algorithm</a> <a href="/leptons-bosons/tags/analyst/" style="font-size: 10px;">analyst</a> <a href="/leptons-bosons/tags/association/" style="font-size: 10px;">association</a> <a href="/leptons-bosons/tags/aws-nitro/" style="font-size: 10px;">aws nitro</a> <a href="/leptons-bosons/tags/binary-index-tree/" style="font-size: 10px;">binary index tree</a> <a href="/leptons-bosons/tags/binary-search/" style="font-size: 10px;">binary search</a> <a href="/leptons-bosons/tags/block-io/" style="font-size: 10px;">block io</a> <a href="/leptons-bosons/tags/bookmark/" style="font-size: 10px;">bookmark</a> <a href="/leptons-bosons/tags/breadth-first-search/" style="font-size: 10px;">breadth-first search</a> <a href="/leptons-bosons/tags/bridge/" style="font-size: 10px;">bridge</a> <a href="/leptons-bosons/tags/calling-conventions/" style="font-size: 10px;">calling conventions</a> <a href="/leptons-bosons/tags/conntrack/" style="font-size: 10px;">conntrack</a> <a href="/leptons-bosons/tags/demo/" style="font-size: 10px;">demo</a> <a href="/leptons-bosons/tags/design-patterns/" style="font-size: 10px;">design patterns</a> <a href="/leptons-bosons/tags/dijkstra/" style="font-size: 10px;">dijkstra</a> <a href="/leptons-bosons/tags/dynamic-programing/" style="font-size: 10px;">dynamic programing</a> <a href="/leptons-bosons/tags/ethernet/" style="font-size: 10px;">ethernet</a> <a href="/leptons-bosons/tags/expert/" style="font-size: 10px;">expert</a> <a href="/leptons-bosons/tags/fenwick-tree/" style="font-size: 10px;">fenwick tree</a> <a href="/leptons-bosons/tags/fibre-channel/" style="font-size: 10px;">fibre channel</a> <a href="/leptons-bosons/tags/flow-offload/" style="font-size: 10px;">flow offload</a> <a href="/leptons-bosons/tags/flow-table/" style="font-size: 10px;">flow table</a> <a href="/leptons-bosons/tags/graph/" style="font-size: 10px;">graph</a> <a href="/leptons-bosons/tags/greedy/" style="font-size: 10px;">greedy</a> <a href="/leptons-bosons/tags/hardware/" style="font-size: 12.5px;">hardware</a> <a href="/leptons-bosons/tags/industry/" style="font-size: 12.5px;">industry</a> <a href="/leptons-bosons/tags/infiniband/" style="font-size: 10px;">infiniband</a> <a href="/leptons-bosons/tags/interface/" style="font-size: 10px;">interface</a> <a href="/leptons-bosons/tags/k-nearest-neighbors/" style="font-size: 10px;">k-nearest-neighbors</a> <a href="/leptons-bosons/tags/kernel/" style="font-size: 12.5px;">kernel</a> <a href="/leptons-bosons/tags/kvm/" style="font-size: 10px;">kvm</a> <a href="/leptons-bosons/tags/memory-layout/" style="font-size: 10px;">memory layout</a> <a href="/leptons-bosons/tags/more-algorithms/" style="font-size: 10px;">more algorithms</a> <a href="/leptons-bosons/tags/netfilter/" style="font-size: 10px;">netfilter</a> <a href="/leptons-bosons/tags/netlink/" style="font-size: 10px;">netlink</a> <a href="/leptons-bosons/tags/network/" style="font-size: 15px;">network</a> <a href="/leptons-bosons/tags/nic/" style="font-size: 10px;">nic</a> <a href="/leptons-bosons/tags/ofprot-trace/" style="font-size: 10px;">ofprot/trace</a> <a href="/leptons-bosons/tags/ovs-sandbox/" style="font-size: 10px;">ovs-sandbox</a> <a href="/leptons-bosons/tags/paper/" style="font-size: 10px;">paper</a> <a href="/leptons-bosons/tags/pcie/" style="font-size: 10px;">pcie</a> <a href="/leptons-bosons/tags/program/" style="font-size: 10px;">program</a> <a href="/leptons-bosons/tags/protocol/" style="font-size: 10px;">protocol</a> <a href="/leptons-bosons/tags/protocols/" style="font-size: 12.5px;">protocols</a> <a href="/leptons-bosons/tags/qemu/" style="font-size: 10px;">qemu</a> <a href="/leptons-bosons/tags/quick-sort/" style="font-size: 10px;">quick sort</a> <a href="/leptons-bosons/tags/segment-tree/" style="font-size: 10px;">segment tree</a> <a href="/leptons-bosons/tags/selection-sort/" style="font-size: 10px;">selection sort</a> <a href="/leptons-bosons/tags/shortest-path/" style="font-size: 10px;">shortest path</a> <a href="/leptons-bosons/tags/simple-search/" style="font-size: 10px;">simple search</a> <a href="/leptons-bosons/tags/storage/" style="font-size: 12.5px;">storage</a> <a href="/leptons-bosons/tags/tcp-syn/" style="font-size: 10px;">tcp syn</a> <a href="/leptons-bosons/tags/tcp-ip/" style="font-size: 10px;">tcp/ip</a> <a href="/leptons-bosons/tags/tool/" style="font-size: 20px;">tool</a> <a href="/leptons-bosons/tags/uml/" style="font-size: 10px;">uml</a> <a href="/leptons-bosons/tags/vim/" style="font-size: 10px;">vim</a> <a href="/leptons-bosons/tags/virtualization/" style="font-size: 15px;">virtualization</a> <a href="/leptons-bosons/tags/vpn/" style="font-size: 10px;">vpn</a> <a href="/leptons-bosons/tags/website/" style="font-size: 10px;">website</a> <a href="/leptons-bosons/tags/wubi/" style="font-size: 10px;">wubi</a> <a href="/leptons-bosons/tags/x86-64/" style="font-size: 10px;">x86_64</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/leptons-bosons/archives/2018/02/">February 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/leptons-bosons/2021/07/29/Building-EDK2-Qemu-From-Scratch-On-Raspberry-Pi/">Building EDK2 Qemu From Scratch On Raspberry Pi</a>
          </li>
        
          <li>
            <a href="/leptons-bosons/2021/03/28/infrastructure-architecture/">Next Generation of Infrastructure Architecture</a>
          </li>
        
          <li>
            <a href="/leptons-bosons/2021/01/13/papers/">The Papers</a>
          </li>
        
          <li>
            <a href="/leptons-bosons/2020/11/22/kvm-weather-report/">The KVM Weather Report</a>
          </li>
        
          <li>
            <a href="/leptons-bosons/2020/10/28/expert-association-map/">Expert &amp; Association Map</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Henry<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/leptons-bosons/" class="mobile-nav-link">Home</a>
  
    <a href="/leptons-bosons/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/leptons-bosons/js/jquery-3.4.1.min.js"></script>



  
<script src="/leptons-bosons/fancybox/jquery.fancybox.min.js"></script>




<script src="/leptons-bosons/js/script.js"></script>





  </div>
</body>
</html>